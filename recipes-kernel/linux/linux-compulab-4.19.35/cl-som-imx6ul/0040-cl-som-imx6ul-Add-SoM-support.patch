From c2cbb204596b56259edcd1801a068f607a8e97d2 Mon Sep 17 00:00:00 2001
From: Valentin Raevsky <valentin@compulab.co.il>
Date: Sun, 17 Apr 2022 11:50:36 +0300
Subject: [PATCH 40/40] cl-som-imx6ul: Add SoM support

Signed-off-by: Valentin Raevsky <valentin@compulab.co.il>
---
 arch/arm/boot/dts/Makefile                    |   2 +
 arch/arm/boot/dts/compulab/Makefile           |  10 +
 .../compulab/imx6ul-cl-som-imx6ul-wilink.dts  |  90 +++
 .../dts/compulab/imx6ul-cl-som-imx6ul.dts     |  16 +
 .../dts/compulab/imx6ul-cl-som-imx6ul.dtsi    | 630 ++++++++++++++++++
 .../dts/compulab/imx6ul-sb-som-imx6ul.dtsi    |  45 ++
 .../dts/compulab/imx6ul-sbc-imx6ul-spi.dts    | 101 +++
 .../dts/compulab/imx6ul-sbc-imx6ul-uarts.dts  | 171 +++++
 .../dts/compulab/imx6ul-sbc-imx6ul-wilink.dts |  11 +
 .../boot/dts/compulab/imx6ul-sbc-imx6ul.dts   |  11 +
 arch/arm/configs/cl-som-imx6ul_defconfig      | 519 +++++++++++++++
 arch/arm/mach-imx/Kconfig                     |   7 +
 arch/arm/mach-imx/Makefile                    |   1 +
 arch/arm/mach-imx/mach-cl-som-imx6ul.c        |  74 ++
 arch/arm/mach-imx/mach-cl_som_imx6.c          | 192 ++++++
 drivers/video/Kconfig                         |   4 +
 drivers/video/Makefile                        |   1 +
 drivers/video/si/Kconfig                      |   6 +
 drivers/video/si/Makefile                     |   2 +
 drivers/video/si/sil164_simple_drv.c          | 241 +++++++
 20 files changed, 2134 insertions(+)
 create mode 100644 arch/arm/boot/dts/compulab/Makefile
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul-wilink.dts
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dts
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dtsi
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-sb-som-imx6ul.dtsi
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-spi.dts
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-uarts.dts
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-wilink.dts
 create mode 100644 arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul.dts
 create mode 100644 arch/arm/configs/cl-som-imx6ul_defconfig
 create mode 100644 arch/arm/mach-imx/mach-cl-som-imx6ul.c
 create mode 100644 arch/arm/mach-imx/mach-cl_som_imx6.c
 create mode 100644 drivers/video/si/Kconfig
 create mode 100644 drivers/video/si/Makefile
 create mode 100644 drivers/video/si/sil164_simple_drv.c

diff --git a/arch/arm/boot/dts/Makefile b/arch/arm/boot/dts/Makefile
index efdb721ffd7e..fe4e55ee0f50 100644
--- a/arch/arm/boot/dts/Makefile
+++ b/arch/arm/boot/dts/Makefile
@@ -1381,3 +1381,5 @@ dtb-$(CONFIG_ARCH_ASPEED) += \
 	aspeed-bmc-opp-zaius.dtb \
 	aspeed-bmc-portwell-neptune.dtb \
 	aspeed-bmc-quanta-q71l.dtb
+
+subdir-y += compulab
diff --git a/arch/arm/boot/dts/compulab/Makefile b/arch/arm/boot/dts/compulab/Makefile
new file mode 100644
index 000000000000..bd3f95c1ce62
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/Makefile
@@ -0,0 +1,10 @@
+dtb-$(CONFIG_SOC_IMX6UL) += imx6ul-cl-som-imx6ul-wilink.dtb
+dtb-$(CONFIG_SOC_IMX6UL) += imx6ul-cl-som-imx6ul.dtb
+dtb-$(CONFIG_SOC_IMX6UL) += imx6ul-sbc-imx6ul-spi.dtb
+dtb-$(CONFIG_SOC_IMX6UL) += imx6ul-sbc-imx6ul-uarts.dtb
+dtb-$(CONFIG_SOC_IMX6UL) += imx6ul-sbc-imx6ul-wilink.dtb
+dtb-$(CONFIG_SOC_IMX6UL) += imx6ul-sbc-imx6ul.dtb
+
+always         := $(dtb-y)
+subdir-y       := $(dts-dirs)
+clean-files    := *.dtb
diff --git a/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul-wilink.dts b/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul-wilink.dts
new file mode 100644
index 000000000000..b11e64bda46e
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul-wilink.dts
@@ -0,0 +1,90 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD.
+ * Copyright (C) 2022 CompuLab LTD.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6ul-cl-som-imx6ul.dts"
+
+/ {
+	regulators {
+		compatible = "simple-bus";
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		wlan_en_reg: wlan_en-reg {
+			compatible = "regulator-fixed";
+			regulator-name = "wlan-en-regulator";
+			regulator-min-microvolt = <1800000>;
+			regulator-max-microvolt = <1800000>;
+			gpio = <&gpio5 1 GPIO_ACTIVE_HIGH>;
+			/* WLAN card specific delay */
+			startup-delay-us = <70000>;
+			enable-active-high;
+		};
+	};
+};
+
+&iomuxc {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_hog_1 &pinctrl_hog_2>;
+	cl-som-imx6ul {
+		pinctrl_hog_2: hoggrp-2 {
+			fsl,pins = <
+				/* Wlan En */
+				MX6UL_PAD_SNVS_TAMPER1__GPIO5_IO01 0x17059
+				/* Wlan IRQ */
+				MX6UL_PAD_SNVS_TAMPER9__GPIO5_IO09 0x17059
+				/* Bt En */
+				MX6UL_PAD_SNVS_TAMPER0__GPIO5_IO00 0x17059
+			>;
+		};
+
+		pinctrl_uart2: uart2grp {
+			fsl,pins = <
+				MX6UL_PAD_UART2_TX_DATA__UART2_DCE_TX 0x1b0b1
+				MX6UL_PAD_UART2_RX_DATA__UART2_DCE_RX 0x1b0b1
+				MX6UL_PAD_UART2_CTS_B__UART2_DCE_CTS 0x1b0b1
+				MX6UL_PAD_UART2_RTS_B__UART2_DCE_RTS 0x1b0b1
+			>;
+		};
+	};
+};
+
+&uart2 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart2>;
+	status = "okay";
+	fsl,uart-has-rtscts;
+
+	bluetooth {
+		compatible = "ti,wl1835-st";
+		enable-gpios = <&gpio5 0 GPIO_ACTIVE_HIGH>;
+	};
+};
+
+&usdhc1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_usdhc1>;
+	/* clean up the removable device fields */
+	cd-gpios = <>;
+	wp-gpios = <>;
+	no-1-8-v;
+	keep-power-in-suspend;
+	enable-sdio-wakeup;
+	vmmc-supply = <&wlan_en_reg>;
+	non-removable;
+	cap-power-off-card;
+	status = "okay";
+	#address-cells = <1>;
+	#size-cells = <0>;
+	wlcore: wlcore@0 {
+		compatible = "ti,wl1835";
+		reg = <2>;
+		interrupt-parent = <&gpio5>;
+		interrupts = <9 IRQ_TYPE_LEVEL_HIGH>;
+	};
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dts b/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dts
new file mode 100644
index 000000000000..3cfdefb2a690
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dts
@@ -0,0 +1,16 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+/dts-v1/;
+
+#include "imx6ul-cl-som-imx6ul.dtsi"
+
+/ {
+	model = "CompuLab CL-SOM-iMX6UL";
+	compatible = "fsl,imx6ul", "compulab,cl-som-imx6ul";
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dtsi b/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dtsi
new file mode 100644
index 000000000000..30376d9dd60c
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-cl-som-imx6ul.dtsi
@@ -0,0 +1,630 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include <dt-bindings/input/input.h>
+#include <dt-bindings/interrupt-controller/irq.h>
+#include "../imx6ul.dtsi"
+
+/ {
+	aliases {
+		gpmi = &gpmi;
+		lcdif = &lcdif;
+	};
+
+	memory {
+		reg = <0x80000000 0x20000000>;
+	};
+
+	chosen {
+		stdout-path = &uart3;
+	};
+
+	backlight {
+		compatible = "pwm-backlight";
+		pwms = <&pwm1 0 5000000>;
+		brightness-levels = <0 4 8 16 32 64 128 255>;
+		default-brightness-level = <6>;
+		status = "okay";
+	};
+
+	pu_dummy: pudummy_reg {
+		compatible = "regulator-fixed";
+		regulator-name = "pu-dummy";
+		regulator-always-on;
+	};
+
+	regulators {
+		compatible = "simple-bus";
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		reg_sd2_vmmc: regulator@0 {
+			compatible = "regulator-fixed";
+			regulator-name = "VSD_3V3";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			gpio = <&gpio4 10 GPIO_ACTIVE_HIGH>;
+			enable-active-high;
+		};
+
+		reg_usb_otg1_vbus: regulator@1 {
+			compatible = "regulator-fixed";
+			pinctrl-names = "default";
+			pinctrl-0 = <&pinctrl_usb_otg1>;
+			regulator-name = "usb_otg1_vbus";
+			regulator-min-microvolt = <5000000>;
+			regulator-max-microvolt = <5000000>;
+			gpio = <&gpio1 4 GPIO_ACTIVE_HIGH>;
+			enable-active-high;
+		};
+
+		reg_phy_nreset: regulator@2 {
+			compatible = "regulator-fixed";
+			regulator-name = "phy_nreset";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			gpio = <&gpio5 8 GPIO_ACTIVE_HIGH>;
+			enable-active-high;
+			regulator-always-on;
+		};
+
+		tsc2046reg: tsc2046-reg {
+			compatible = "regulator-fixed";
+			regulator-name = "tsc2046-reg";
+			regulator-min-microvolt = <3300000>;
+			regulator-max-microvolt = <3300000>;
+			regulator-always-on;
+		};
+
+	};
+
+	leds {
+		compatible = "gpio-leds";
+
+		debug-led {
+			label = "Heartbeat";
+			gpios = <&gpio5 4 0>;
+			linux,default-trigger = "heartbeat";
+		};
+	};
+
+	sound {
+		compatible = "simple-audio-card";
+		simple-audio-card,name = "cl-som-imx6ul";
+		simple-audio-card,widgets =
+			"Headphone", "Headphone Jack",
+			"Line", "Line Out",
+			"Microphone", "Mic Jack",
+			"Line", "Line In";
+		simple-audio-card,routing =
+			"Headphone Jack", "RHPOUT",
+			"Headphone Jack", "LHPOUT",
+			"MICIN", "Mic Bias",
+			"Mic Bias", "Mic Jack";
+		simple-audio-card,format = "i2s";
+		simple-audio-card,bitclock-master = <&sound_master>;
+		simple-audio-card,frame-master = <&sound_master>;
+		simple-audio-card,bitclock-inversion;
+
+		sound_master: simple-audio-card,cpu {
+			sound-dai = <&sai2 0>;
+			system-clock-frequency = <12288000>;
+			system-clock-direction = "out";
+		};
+
+		simple-audio-card,codec {
+			sound-dai = <&wm8731>;
+			system-clock-direction = "in";
+			system-clock-type = "mclk";
+		};
+
+	};
+};
+
+&cpu0 {
+	arm-supply = <&reg_arm>;
+	soc-supply = <&reg_soc>;
+};
+
+&clks {
+	assigned-clocks = <&clks IMX6UL_CLK_PLL4_AUDIO_DIV>;
+	assigned-clock-rates = <786432000>;
+};
+
+&iomuxc {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_hog_1>;
+	cl-som-imx6ul {
+		pinctrl_hog_1: hoggrp-1 {
+			fsl,pins = <
+				/* Heartbeat */
+				MX6UL_PAD_SNVS_TAMPER4__GPIO5_IO04 0x17059
+				/* Phy nReset */
+				MX6UL_PAD_SNVS_TAMPER8__GPIO5_IO08	0x17059
+			>;
+		};
+
+		pinctrl_enet1: enet1grp {
+			fsl,pins = <
+				MX6UL_PAD_GPIO1_IO07__ENET1_MDC		0x1b0b0
+				MX6UL_PAD_GPIO1_IO06__ENET1_MDIO	0x1b0b0
+				MX6UL_PAD_ENET1_RX_EN__ENET1_RX_EN	0x1b0b0
+				MX6UL_PAD_ENET1_RX_ER__ENET1_RX_ER	0x1b0b0
+				MX6UL_PAD_ENET1_RX_DATA0__ENET1_RDATA00	0x1b0b0
+				MX6UL_PAD_ENET1_RX_DATA1__ENET1_RDATA01	0x1b0b0
+				MX6UL_PAD_ENET1_TX_EN__ENET1_TX_EN	0x1b0b0
+				MX6UL_PAD_ENET1_TX_DATA0__ENET1_TDATA00	0x1b0b0
+				MX6UL_PAD_ENET1_TX_DATA1__ENET1_TDATA01	0x1b0b0
+				MX6UL_PAD_ENET1_TX_CLK__ENET1_REF_CLK1	0x4001b031
+				MX6UL_PAD_SNVS_TAMPER5__GPIO5_IO05	0x80000000
+			>;
+		};
+
+		pinctrl_uart2: uart2grp {
+			fsl,pins = <
+				MX6UL_PAD_UART2_TX_DATA__UART2_DCE_TX 0x1b0b1
+				MX6UL_PAD_UART2_RX_DATA__UART2_DCE_RX 0x1b0b1
+				MX6UL_PAD_UART2_CTS_B__UART2_DCE_CTS 0x1b0b1
+				MX6UL_PAD_UART2_RTS_B__UART2_DCE_RTS 0x1b0b1
+			>;
+		};
+
+		pinctrl_uart3: uart3grp {
+			fsl,pins = <
+				MX6UL_PAD_UART3_TX_DATA__UART3_DCE_TX 0x1b0b1
+				MX6UL_PAD_UART3_RX_DATA__UART3_DCE_RX 0x1b0b1
+			>;
+		};
+
+		pinctrl_usdhc1: usdhc1grp {
+			fsl,pins = <
+				MX6UL_PAD_SD1_CMD__USDHC1_CMD     0x100F9
+				MX6UL_PAD_SD1_CLK__USDHC1_CLK     0x17059
+				MX6UL_PAD_SD1_DATA0__USDHC1_DATA0 0x100F9
+				MX6UL_PAD_SD1_DATA1__USDHC1_DATA1 0x100F9
+				MX6UL_PAD_SD1_DATA2__USDHC1_DATA2 0x100F9
+				MX6UL_PAD_SD1_DATA3__USDHC1_DATA3 0x100F9
+				MX6UL_PAD_UART1_RTS_B__GPIO1_IO19 0x17059
+				MX6UL_PAD_UART1_CTS_B__GPIO1_IO18 0x17059
+			>;
+		};
+
+		pinctrl_usdhc2: usdhc2grp {
+			fsl,pins = <
+				MX6UL_PAD_NAND_ALE__GPIO4_IO10	0x17059
+				MX6UL_PAD_NAND_DATA00__USDHC2_DATA0 0x1F059
+				MX6UL_PAD_NAND_DATA01__USDHC2_DATA1 0x1F059
+				MX6UL_PAD_NAND_DATA02__USDHC2_DATA2 0x1F059
+				MX6UL_PAD_NAND_DATA03__USDHC2_DATA3 0x1F059
+				MX6UL_PAD_NAND_DATA04__USDHC2_DATA4 0x1F059
+				MX6UL_PAD_NAND_DATA05__USDHC2_DATA5 0x1F059
+				MX6UL_PAD_NAND_DATA06__USDHC2_DATA6 0x1F059
+				MX6UL_PAD_NAND_DATA07__USDHC2_DATA7 0x1F059
+				MX6UL_PAD_NAND_WE_B__USDHC2_CMD	0x1F059
+				MX6UL_PAD_NAND_RE_B__USDHC2_CLK	0x17059
+			>;
+		};
+
+		pinctrl_gpmi_nand: gpminand1grp {
+			fsl,pins = <
+				MX6UL_PAD_NAND_CLE__RAWNAND_CLE         0xb0b1
+				MX6UL_PAD_NAND_ALE__RAWNAND_ALE         0xb0b1
+				MX6UL_PAD_NAND_WP_B__RAWNAND_WP_B       0xb0b1
+				MX6UL_PAD_NAND_READY_B__RAWNAND_READY_B 0xb000
+				MX6UL_PAD_NAND_CE0_B__RAWNAND_CE0_B     0xb0b1
+				MX6UL_PAD_NAND_CE1_B__RAWNAND_CE1_B     0xb0b1
+				MX6UL_PAD_NAND_RE_B__RAWNAND_RE_B       0xb0b1
+				MX6UL_PAD_NAND_WE_B__RAWNAND_WE_B       0xb0b1
+				MX6UL_PAD_NAND_DATA00__RAWNAND_DATA00   0xb0b1
+				MX6UL_PAD_NAND_DATA01__RAWNAND_DATA01   0xb0b1
+				MX6UL_PAD_NAND_DATA02__RAWNAND_DATA02   0xb0b1
+				MX6UL_PAD_NAND_DATA03__RAWNAND_DATA03   0xb0b1
+				MX6UL_PAD_NAND_DATA04__RAWNAND_DATA04   0xb0b1
+				MX6UL_PAD_NAND_DATA05__RAWNAND_DATA05   0xb0b1
+				MX6UL_PAD_NAND_DATA06__RAWNAND_DATA06   0xb0b1
+				MX6UL_PAD_NAND_DATA07__RAWNAND_DATA07   0xb0b1
+			>;
+		};
+
+		/* pins for spi */
+		pinctrl_ecspi4_cs: ecspi4_cs_grp {
+			fsl,pins = <
+				MX6UL_PAD_ENET2_RX_ER__GPIO2_IO15	0x17059
+				MX6UL_PAD_LCD_RESET__GPIO3_IO04  0x17059
+			>;
+		};
+
+		pinctrl_ecspi4: ecspi4grp {
+			fsl,pins = <
+				MX6UL_PAD_ENET2_TX_EN__ECSPI4_MOSI	0x1b0b1
+				MX6UL_PAD_ENET2_TX_CLK__ECSPI4_MISO	0x1b0b1
+				MX6UL_PAD_ENET2_TX_DATA1__ECSPI4_SCLK	0x1b0b1
+			>;
+		};
+
+		pinctrl_i2c1: i2c1grp {
+			fsl,pins = <
+				MX6UL_PAD_GPIO1_IO02__I2C1_SCL	0x4001b8b0
+				MX6UL_PAD_GPIO1_IO03__I2C1_SDA	0x4001b8b0
+			>;
+		};
+
+		pinctrl_i2c3: i2c3grp {
+			fsl,pins = <
+				MX6UL_PAD_UART1_TX_DATA__I2C3_SCL 0x4001b8b0
+				MX6UL_PAD_UART1_RX_DATA__I2C3_SDA 0x4001b8b0
+			>;
+		};
+
+		pinctrl_sai2: sai2grp {
+			fsl,pins = <
+				MX6UL_PAD_JTAG_TDI__SAI2_TX_BCLK	0x17088
+				MX6UL_PAD_JTAG_TDO__SAI2_TX_SYNC	0x17088
+				MX6UL_PAD_JTAG_TRST_B__SAI2_TX_DATA	0x11088
+				MX6UL_PAD_JTAG_TCK__SAI2_RX_DATA	0x11088
+				MX6UL_PAD_JTAG_TMS__SAI2_MCLK		0x17088
+			>;
+		};
+
+		pinctrl_usb_otg1_id: usbotg1idgrp {
+			fsl,pins = <
+				MX6UL_PAD_GPIO1_IO00__ANATOP_OTG1_ID	0x17059
+			>;
+		};
+
+		pinctrl_usb_otg1: usbotg1grp {
+			fsl,pins = <
+				MX6UL_PAD_GPIO1_IO04__GPIO1_IO04        0x10b0
+			>;
+		};
+
+		pinctrl_lcdif_dat: lcdifdatgrp {
+			fsl,pins = <
+				MX6UL_PAD_LCD_DATA00__LCDIF_DATA00  0x79
+				MX6UL_PAD_LCD_DATA01__LCDIF_DATA01  0x79
+				MX6UL_PAD_LCD_DATA02__LCDIF_DATA02  0x79
+				MX6UL_PAD_LCD_DATA03__LCDIF_DATA03  0x79
+				MX6UL_PAD_LCD_DATA04__LCDIF_DATA04  0x79
+				MX6UL_PAD_LCD_DATA05__LCDIF_DATA05  0x79
+				MX6UL_PAD_LCD_DATA06__LCDIF_DATA06  0x79
+				MX6UL_PAD_LCD_DATA07__LCDIF_DATA07  0x79
+				MX6UL_PAD_LCD_DATA08__LCDIF_DATA08  0x79
+				MX6UL_PAD_LCD_DATA09__LCDIF_DATA09  0x79
+				MX6UL_PAD_LCD_DATA10__LCDIF_DATA10  0x79
+				MX6UL_PAD_LCD_DATA11__LCDIF_DATA11  0x79
+				MX6UL_PAD_LCD_DATA12__LCDIF_DATA12  0x79
+				MX6UL_PAD_LCD_DATA13__LCDIF_DATA13  0x79
+				MX6UL_PAD_LCD_DATA14__LCDIF_DATA14  0x79
+				MX6UL_PAD_LCD_DATA15__LCDIF_DATA15  0x79
+				MX6UL_PAD_LCD_DATA16__LCDIF_DATA16  0x79
+				MX6UL_PAD_LCD_DATA17__LCDIF_DATA17  0x79
+				MX6UL_PAD_LCD_DATA18__LCDIF_DATA18  0x79
+				MX6UL_PAD_LCD_DATA19__LCDIF_DATA19  0x79
+				MX6UL_PAD_LCD_DATA20__LCDIF_DATA20  0x79
+				MX6UL_PAD_LCD_DATA21__LCDIF_DATA21  0x79
+				MX6UL_PAD_LCD_DATA22__LCDIF_DATA22  0x79
+				MX6UL_PAD_LCD_DATA23__LCDIF_DATA23  0x79
+			>;
+		};
+
+		pinctrl_lcdif_ctrl: lcdifctrlgrp {
+			fsl,pins = <
+				MX6UL_PAD_LCD_CLK__LCDIF_CLK	    0x79
+				MX6UL_PAD_LCD_ENABLE__LCDIF_ENABLE  0x79
+				MX6UL_PAD_LCD_HSYNC__LCDIF_HSYNC    0x79
+				MX6UL_PAD_LCD_VSYNC__LCDIF_VSYNC    0x79
+			>;
+		};
+
+		pinctrl_pwm1: pwm1grp {
+			fsl,pins = <
+				MX6UL_PAD_GPIO1_IO08__PWM1_OUT   0x110b0
+			>;
+		};
+
+		pinctrl_tsc2046: tsc2046grp {
+			fsl,pins = <
+				/* tsc2046 PENDOWN */
+				MX6UL_PAD_GPIO1_IO01__GPIO1_IO01  0x80000000
+			>;
+		};
+
+		pinctrl_flexcan1: flexcan1grp{
+			fsl,pins = <
+				MX6UL_PAD_UART3_RTS_B__FLEXCAN1_RX	0x1b020
+				MX6UL_PAD_UART3_CTS_B__FLEXCAN1_TX	0x1b020
+			>;
+		};
+
+		pinctrl_wdog: wdoggrp {
+			fsl,pins = <
+				MX6UL_PAD_LCD_RESET__WDOG1_WDOG_ANY    0x30b0
+			>;
+		};
+
+		pinctrl_uart6: uart6grp {
+			fsl,pins = <
+				MX6UL_PAD_CSI_PIXCLK__UART6_DCE_RX 0x1b0b1 /* P1_95 */
+				MX6UL_PAD_CSI_MCLK__UART6_DCE_TX 0x1b01    /* P1_97 */
+			>;
+		};
+
+		pinctrl_uart6_1: uart6grp1 {
+			fsl,pins = <
+				MX6UL_PAD_ENET2_RX_DATA0__UART6_DCE_TX 0x1b0b1 /* P1_3 */
+				MX6UL_PAD_ENET2_RX_DATA1__UART6_DCE_RX 0x1b0b1 /* P1_5 */
+			>;
+		};
+	};
+};
+
+&uart3 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart3>;
+	status = "okay";
+};
+
+&usdhc1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_usdhc1>;
+	cd-gpios = <&gpio1 19 GPIO_ACTIVE_LOW>;
+	wp-gpios = <&gpio1 18 GPIO_ACTIVE_HIGH>;
+	keep-power-in-suspend;
+	enable-sdio-wakeup;
+	status = "okay";
+};
+
+/* emmc */
+&usdhc2 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_usdhc2>;
+	keep-power-in-suspend;
+	enable-sdio-wakeup;
+	non-removable;
+	vmmc-supply = <&reg_sd2_vmmc>;
+	status = "okay";
+};
+
+/* nand */
+&gpmi {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_gpmi_nand>;
+	nand-on-flash-bbt;
+	depends = &ecspi4;
+	status = "disabled";
+
+	partition@0 {
+		label = "linux";
+		reg = <0x0 0x800000>;
+	};
+
+	partition@800000 {
+		label = "rootfs";
+		reg = <0x800000 0x0>;
+	};
+};
+
+&ecspi4 {
+	fsl,spi-num-chipselects = <2>;
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_ecspi4 &pinctrl_ecspi4_cs>;
+	cs-gpios = <&gpio2 15 0>, <&gpio3 4 0>;
+	status = "okay";
+
+	m25px16@0 {
+		#address-cells = <1>;
+		#size-cells = <1>;
+		compatible = "st,m25p16", "st,m25p";
+		spi-max-frequency = <20000000>;
+		reg = <0>;
+
+		partition@0 {
+			label = "uboot";
+			reg = <0x0 0xc0000>;
+		};
+
+		partition@c0000 {
+			label = "uboot environment";
+			reg = <0xc0000 0x2000>;
+		};
+
+		partition@100000 {
+			label = "splash";
+			reg = <0x100000 0x100000>;
+		};
+	};
+
+	/* touch controller */
+	touch:	tsc2046@0 {
+		pinctrl-names = "default";
+		pinctrl-0 = <&pinctrl_tsc2046>;
+
+		compatible = "ti,tsc2046";
+		vcc-supply = <&tsc2046reg>;
+
+		reg = <1>;
+		spi-max-frequency = <1500000>;
+
+		interrupt-parent = <&gpio1>;
+		interrupts = <1 0>;
+		pendown-gpio = <&gpio1 1 0>;
+
+		ti,x-min = /bits/ 16 <0x0>;
+		ti,x-max = /bits/ 16 <0x0fff>;
+		ti,y-min = /bits/ 16 <0x0>;
+		ti,y-max = /bits/ 16 <0x0fff>;
+
+		ti,x-plate-ohms = /bits/ 16 <180>;
+		ti,pressure-max = /bits/ 16 <255>;
+
+		ti,debounce-max = /bits/ 16 <30>;
+		ti,debounce-tol = /bits/ 16 <10>;
+		ti,debounce-rep = /bits/ 16 <1>;
+
+		linux,wakeup;
+	};
+};
+
+&fec1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_enet1>;
+	phy-mode = "rmii";
+	phy-handle = <&ethphy0>;
+	status = "okay";
+
+	mdio {
+		#address-cells = <1>;
+		#size-cells = <0>;
+
+		ethphy0: ethernet-phy@0 {
+			compatible = "ethernet-phy-ieee802.3-c22";
+			reg = <0>;
+		};
+	};
+};
+
+&i2c1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_i2c1>;
+	status = "disabled";
+};
+
+&i2c3 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_i2c3>;
+	status = "okay";
+
+	wm8731: wm8731@1a {
+		#sound-dai-cells = <0>;
+		compatible = "wlf,wm8731";
+		reg = <0x1a>;
+		status = "okay";
+		clocks = <&clks IMX6UL_CLK_SAI2>;
+		clock-names = "mclk";
+		AVDD-supply = <&pu_dummy>;
+		HPVDD-supply = <&pu_dummy>;
+		DCVDD-supply = <&pu_dummy>;
+		DBVDD-supply = <&pu_dummy>;
+	};
+
+	eeprom@50 {
+		compatible = "at24,24c02";
+		reg = <0x50>;
+		pagesize = <16>;
+	};
+
+	rtc@56 {
+		compatible = "emmicro,em3027";
+		reg = <0x56>;
+	};
+};
+
+&usbotg1 {
+	vbus-supply = <&reg_usb_otg1_vbus>;
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_usb_otg1_id>;
+	dr_mode = "otg";
+	status = "okay";
+};
+
+&usbotg2 {
+	dr_mode = "host";
+	disable-over-current;
+	status = "okay";
+};
+
+&pwm1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_pwm1>;
+	status = "okay";
+};
+
+&lcdif {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_lcdif_dat
+		     &pinctrl_lcdif_ctrl>;
+	display = <&display0>;
+	status = "okay";
+
+	display0: display {
+		bits-per-pixel = <16>;
+		bus-width = <24>;
+
+		display-timings {
+			native-mode = <&timing1>;
+			timing0: lcd {
+				clock-frequency = <29580000>;
+				hactive = <800>;
+				vactive = <480>;
+				hfront-porch = <16>;
+				hback-porch = <1>;
+				hsync-len = <80>;
+				vback-porch = <13>;
+				vfront-porch = <16>;
+				vsync-len = <16>;
+
+				hsync-active = <0>;
+				vsync-active = <0>;
+				de-active = <1>;
+				pixelclk-active = <0>;
+			};
+			timing1: dvi {
+				/* 1024x768p60 */
+				clock-frequency = <65000000>;
+				hactive = <1024>;
+				vactive = <768>;
+				hback-porch = <220>;
+				hfront-porch = <40>;
+				vback-porch = <21>;
+				vfront-porch = <7>;
+				hsync-len = <60>;
+				vsync-len = <10>;
+
+				hsync-active = <0>;
+				vsync-active = <0>;
+				de-active = <1>;
+				pixelclk-active = <0>;
+			};
+		};
+	};
+};
+
+&can1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_flexcan1>;
+	status = "okay";
+};
+
+&sai2 {
+	#sound-dai-cells = <0>;
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_sai2>;
+
+	assigned-clocks = <&clks IMX6UL_CLK_SAI2_SEL>,
+			  <&clks IMX6UL_CLK_SAI2>;
+	assigned-clock-parents = <&clks IMX6UL_CLK_PLL4_AUDIO_DIV>;
+	assigned-clock-rates = <0>, <12288000>;
+
+	status = "okay";
+};
+
+&snvs_rtc {
+	status = "disabled";
+};
+
+&wdog1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_wdog>;
+	fsl,wdog_b;
+};
+
+&uart6 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart6>;
+	status = "okay";
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-sb-som-imx6ul.dtsi b/arch/arm/boot/dts/compulab/imx6ul-sb-som-imx6ul.dtsi
new file mode 100644
index 000000000000..f52b4d14299a
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-sb-som-imx6ul.dtsi
@@ -0,0 +1,45 @@
+/*
+ * Suppport for CompuLab SB-SOM baseboard
+ */
+
+/ {
+	reg_lcd_nstby_3v3: lcd_nstby_3v3 {
+		compatible = "regulator-fixed";
+		regulator-name = "lcd_nstby_3v3";
+		gpio = <&pca9555 14 0>;
+		enable-active-high;
+		regulator-always-on;
+	};
+
+	reg_div_en_3v3: div_en_3v3 {
+		compatible = "regulator-fixed";
+		regulator-name = "dvi_en_3v3";
+		gpio = <&pca9555 13 0>;
+		enable-active-high;
+		regulator-always-on;
+	};
+
+};
+
+&i2c1 {
+	status = "okay";
+
+	eeprom@54 {
+		compatible = "at24,24c02";
+		reg = <0x54>;
+		pagesize = <16>;
+	};
+
+	pca9555: pca9555@20 {
+		compatible = "nxp,pca9555";
+		gpio-controller;
+		#gpio-cells = <2>;
+		reg = <0x20>;
+	};
+
+	dvicape {
+		compatible = "sil164_simple";
+		reg = <0x39>;
+		powerdn-gpio = <&pca9555 13 0>;
+	};
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-spi.dts b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-spi.dts
new file mode 100644
index 000000000000..76a5d51f5184
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-spi.dts
@@ -0,0 +1,101 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6ul-cl-som-imx6ul.dts"
+
+#if __SPI_EXAMPLE__
+
+SPI 1 Interface Signals
+
+SPI1_CLK         77*     O                                     Always available
+SPI1_CLK        146*     O                                     Always available
+SPI1_CS0_N      79*      O     SPI-1 Chip select 0             Always available
+SPI1_CS0_N      148*     O     SPI-1 Chip select 0             Always available
+SPI1_CS1_N      118*     O     SPI-1 Chip select 1             Always available
+SPI1_CS2_N      120*      O        SPI-1 Chip select 2            Always available
+SPI1_CS3_N      122*      O        SPI-1 Chip select 3            Always available
+SPI1_MISO       76*       I                                       Always available
+SPI1_MISO       85*       I                                       Always available
+SPI1_MOSI       74*       O                                       Always available
+SPI1_MOSI       86*       O       data out                       'W' and 'WAB' options
+
+SPI 2 Interface Signals
+
+SPI2_CLK         101*         O     SPI-2 Master clock out; slave clock in      Always available
+SPI2_CLK          69          O     SPI-2 Master clock out; slave clock in      Only in revision starting 1.1
+SPI2_CS0_N       103*         O     SPI-2 Chip select 0                         Always available
+SPI2_CS0_N        58          O     SPI-2 Chip select 0                         Only in revision starting 1.1
+SPI2_CS1_N       100*         O     SPI-2 Chip select 1                         Always available
+SPI2_CS2_N       102*         O     SPI-2 Chip select 2                         Always available
+SPI2_CS3_N       154*         O     SPI-2 Chip select 3                         Always available
+SPI2_MISO         91*         I     SPI-2 Master data out; slave data in        Always available
+SPI2_MISO         63          I     SPI-2 Master data out; slave data in        Only in revision starting 1.1
+SPI2_MOSI         89*         O     SPI-2 Master data in; slave data out        Always available
+SPI2_MOSI         65          O     SPI-2 Master data in; slave data out        Only in revision starting 1.1
+
+SPI 3 Interface Signals
+
+SPI3_CLK          13*          O     SPI-3 Master clock out; slave clock in          Only w/o ‘WAB’ option.
+SPI3_CS0_N        11*          O     SPI-3 Chip select 0                             Only w/o ‘WAB’ option.
+SPI3_MISO          9*          I     SPI-3 Master data out; slave data in            Only w/o ‘WAB’ option.
+SPI3_MOSI          7*          O     SPI-3 Master data in; slave data out            Only w/o ‘WAB’ option.
+
+#endif // __SPI_EXAMPLE__
+
+&iomuxc {
+	cl-som-imx6ul-spi {
+
+		pinctrl_ecspi1: ecspi1grp {
+			fsl,pins = <
+				MX6UL_PAD_CSI_DATA04__ECSPI1_SCLK	0x1b0b1	
+				MX6UL_PAD_LCD_DATA22__ECSPI1_MOSI	0x1b0b1
+				MX6UL_PAD_LCD_DATA23__ECSPI1_MISO	0x1b0b1
+			>;
+		};
+
+		pinctrl_ecspi1_cs: ecspi1csgrp {
+			fsl,pins = <
+				MX6UL_PAD_CSI_DATA05__GPIO4_IO26	0x17059	
+				MX6UL_PAD_LCD_DATA05__GPIO3_IO10	0x17059	
+				MX6UL_PAD_LCD_DATA06__GPIO3_IO11	0x17059 
+				MX6UL_PAD_LCD_DATA07__GPIO3_IO12	0x17059
+			>;
+		};
+
+	};
+};
+
+&ecspi1 {
+	fsl,spi-num-chipselects = <4>;
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_ecspi1 &pinctrl_ecspi1_cs>;
+	cs-gpios = <&gpio4 26 0>, <&gpio3 10 0>, <&gpio3 11 0>, <&gpio3 12 0>;
+	status = "okay";
+
+	/* spidev examlpe */
+	spidev@0 {
+		compatible = "rohm,dh2228fv";
+		spi-max-frequency = <30000000>;
+		reg = <0>;
+	};
+	spidev@1 {
+		compatible = "rohm,dh2228fv";
+		spi-max-frequency = <30000000>;
+		reg = <1>;
+	};
+	spidev@2 {
+		compatible = "rohm,dh2228fv";
+		spi-max-frequency = <30000000>;
+		reg = <2>;
+	};
+	spidev@3 {
+		compatible = "rohm,dh2228fv";
+		spi-max-frequency = <30000000>;
+		reg = <3>;
+	};
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-uarts.dts b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-uarts.dts
new file mode 100644
index 000000000000..8dac0b6044b5
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-uarts.dts
@@ -0,0 +1,171 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD.
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include "imx6ul-cl-som-imx6ul.dts"
+
+#if __UART_EXAMPLE__
+
+Signal Name | Pin # | Type | Description Availability
+
+UART1_CTS 67* I UART-1 clear to send. Always available
+UART1_RTS 61* O UART-1 request to send. Always available
+UART1_RX 135* I UART-1 serial data receive Always available
+UART1_TX 129* O UART-1 serial data transmit Always available
+
+/* Bluetooth */
+UART2_CTS 17* I UART-2 clear to send. Only w/o ‘WAB’ option.
+UART2_RTS 15* O UART-2 request to send. Only w/o ‘WAB’ option.
+UART2_RX 13* I UART-2 serial data receive Only w/o ‘WAB’ option.
+UART2_TX 11* O UART-2 serial data transmit Only w/o ‘WAB’ option.
+
+/* Debug Console */
+UART3_CTS 52* I UART-3 clear to send. Always available
+UART3_CTS 71 I UART-3 clear to send. Always available
+UART3_RTS 9* O UART-3 request to send Only w/o ‘WAB’ option.
+UART3_RX 117* I UART-3 serial data receive Always available
+UART3_TX 111* O UART-3 serial data transmit Always available
+
+
+UART3_CTS 52* I UART-3 clear to send. Always available
+UART3_CTS 71 I UART-3 clear to send. Always available
+UART3_RTS 9* O UART-3 request to send Only w/o ‘WAB’ option.
+UART3_RX 117* I UART-3 serial data receive Always available
+UART3_TX 111* O UART-3 serial data transmit Always available
+
+UART4_CTS 100* I UART-4 clear to send. Always available
+UART4_RTS 102* O UART-4 request to send Always available
+UART4_RX 104* I UART-4 serial data receive Always available
+UART4_TX 98* O UART-4 serial data transmit Always available
+
+UART5_CTS 91* I UART-5 clear to send. Always available
+UART5_CTS 194* I UART-5 clear to send. Always available
+UART5_RTS 73* O UART-5 request to send. Always available
+UART5_RTS 89* O UART-5 request to send. Always available
+UART5_RX 63* I UART-5 serial data receive Always available
+UART5_RX 103* I UART-5 serial data receive Always available
+UART5_TX 65* O UART-5 serial data transmit Always available
+UART5_TX 101* O UART-5 serial data transmit Always available
+
+UART6_CTS 115* I UART-6 clear to send. Always available
+UART6_RTS 113* O UART-6 request to send. Always available
+UART6_RX 5* I UART-6 serial data receive Always available
+UART6_RX 95* I UART-6 serial data receive Always available
+UART6_TX 3* O UART-6 serial data transmit Always available
+UART6_TX 97* O UART-6 serial data transmit Always available
+
+UART7_CTS 120* I UART-7 clear to send. Always available
+UART7_RTS 122* O UART-7 request to send. Always available
+UART7_RX 92* I UART-7 serial data receive Always available
+UART7_TX 94* O UART-7 serial data transmit Always available
+
+UART8_CTS 116* I UART-8 clear to send. Always available
+UART8_RTS 118* O UART-8 request to send. Always available
+UART8_RX 148* I UART-8 serial data receive Always available
+UART8_TX 146* O UART-8 serial data transmit Always available
+
+#endif // __UART_EXAMPLE__
+
+&iomuxc {
+	cl-som-imx6ul-uarts {
+
+		pinctrl_uart1: uart1grp {
+			fsl,pins = <
+				MX6UL_PAD_UART1_CTS_B__UART1_DCE_CTS 0x1b0b1
+				MX6UL_PAD_UART1_RTS_B__UART1_DCE_RTS 0x1b0b1
+				MX6UL_PAD_GPIO1_IO03__UART1_DCE_RX 0x1b0b1
+				MX6UL_PAD_GPIO1_IO02__UART1_DCE_TX 0x1b0b1
+			>;
+		};
+
+		pinctrl_uart4: uart4grp {
+			fsl,pins = <
+				MX6UL_PAD_LCD_HSYNC__UART4_DCE_CTS 0x1b0b1 
+				MX6UL_PAD_LCD_VSYNC__UART4_DCE_RTS 0x1b0b1
+				MX6UL_PAD_LCD_ENABLE__UART4_DCE_RX 0x1b0b1
+				MX6UL_PAD_LCD_CLK__UART4_DCE_TX 0x1b0b1
+			>;
+		};
+
+		pinctrl_uart5: uart5grp {
+			fsl,pins = <
+				MX6UL_PAD_UART5_RX_DATA__UART5_DCE_RX 0x1b0b1 /* P4_2 */
+				MX6UL_PAD_UART5_TX_DATA__UART5_DCE_TX 0x1b0b1 /* P4_4 */
+			>;
+		};
+
+		pinctrl_uart6_x: uart6grp1 {
+			fsl,pins = <
+				MX6UL_PAD_ENET2_RX_DATA0__UART6_DCE_TX 0x1b0b1 /* P1_3 */
+				MX6UL_PAD_ENET2_RX_DATA1__UART6_DCE_RX 0x1b0b1 /* P1_5 */
+			>;
+		};
+
+		pinctrl_uart7: uart7grp {
+			fsl,pins = <
+				MX6UL_PAD_LCD_DATA06__UART7_DCE_CTS 0x1b0b1
+				MX6UL_PAD_LCD_DATA07__UART7_DCE_RTS 0x1b0b1
+				MX6UL_PAD_LCD_DATA17__UART7_DCE_RX 0x1b0b1
+				MX6UL_PAD_LCD_DATA16__UART7_DCE_TX 0x1b0b1
+			>;
+		};
+
+		pinctrl_uart8: uart8grp {
+			fsl,pins = <
+				MX6UL_PAD_LCD_DATA04__UART8_DCE_CTS 0x1b0b1
+				MX6UL_PAD_LCD_DATA05__UART8_DCE_RTS 0x1b0b1
+				MX6UL_PAD_LCD_DATA20__UART8_DCE_TX 0x1b0b1
+				MX6UL_PAD_LCD_DATA21__UART8_DCE_RX 0x1b0b1
+
+			>;
+		};
+	};
+};
+
+&uart1 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart1>;
+	status = "okay";
+	/* enable rts/cts */
+	fsl,uart-has-rtscts;
+};
+
+&uart4 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart4>;
+	status = "okay";
+	/* enable rts/cts */
+	fsl,uart-has-rtscts;
+};
+
+&uart5 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart5>;
+	status = "okay";
+};
+
+&uart6 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart6_x>;
+	status = "okay";
+};
+
+&uart7 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart7>;
+	status = "okay";
+	/* enable rts/cts */
+	fsl,uart-has-rtscts;
+};
+
+&uart8 {
+	pinctrl-names = "default";
+	pinctrl-0 = <&pinctrl_uart8>;
+	status = "okay";
+	/* enable rts/cts */
+	fsl,uart-has-rtscts;
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-wilink.dts b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-wilink.dts
new file mode 100644
index 000000000000..bdef44c1beea
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul-wilink.dts
@@ -0,0 +1,11 @@
+/*
+ * Suppport for CompuLab SB-SOM-iMX6UL baseboard
+ */
+
+#include "imx6ul-cl-som-imx6ul-wilink.dts"
+#include "imx6ul-sb-som-imx6ul.dtsi"
+
+/ {
+	model = "CompuLab CL-SOM-iMX6UL on SBC-SOM-iMX6UL";
+	compatible = "fsl,imx6ul", "compulab,cl-som-imx6ul", "compulab,sbc-imx6ul";
+};
diff --git a/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul.dts b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul.dts
new file mode 100644
index 000000000000..48a939d9e1d8
--- /dev/null
+++ b/arch/arm/boot/dts/compulab/imx6ul-sbc-imx6ul.dts
@@ -0,0 +1,11 @@
+/*
+ * Suppport for CompuLab SB-SOM-iMX6UL baseboard
+ */
+
+#include "imx6ul-cl-som-imx6ul.dts"
+#include "imx6ul-sb-som-imx6ul.dtsi"
+
+/ {
+	model = "CompuLab CL-SOM-iMX6UL on SBC-SOM-iMX6UL";
+	compatible = "fsl,imx6ul", "compulab,cl-som-imx6ul", "compulab,sbc-imx6ul";
+};
diff --git a/arch/arm/configs/cl-som-imx6ul_defconfig b/arch/arm/configs/cl-som-imx6ul_defconfig
new file mode 100644
index 000000000000..43b460e18357
--- /dev/null
+++ b/arch/arm/configs/cl-som-imx6ul_defconfig
@@ -0,0 +1,519 @@
+CONFIG_LOCALVERSION="-cl-som-imx6ul"
+CONFIG_KERNEL_LZO=y
+CONFIG_SYSVIPC=y
+CONFIG_NO_HZ=y
+CONFIG_HIGH_RES_TIMERS=y
+CONFIG_PREEMPT=y
+CONFIG_IKCONFIG=y
+CONFIG_IKCONFIG_PROC=y
+CONFIG_LOG_BUF_SHIFT=18
+CONFIG_CGROUPS=y
+CONFIG_CGROUP_SCHED=y
+CONFIG_CFS_BANDWIDTH=y
+CONFIG_NAMESPACES=y
+CONFIG_CHECKPOINT_RESTORE=y
+CONFIG_RELAY=y
+CONFIG_BLK_DEV_INITRD=y
+# CONFIG_RD_BZIP2 is not set
+# CONFIG_RD_LZMA is not set
+# CONFIG_RD_XZ is not set
+# CONFIG_RD_LZO is not set
+# CONFIG_RD_LZ4 is not set
+CONFIG_EXPERT=y
+CONFIG_KALLSYMS_ALL=y
+# CONFIG_SLUB_DEBUG is not set
+# CONFIG_COMPAT_BRK is not set
+CONFIG_ARCH_MXC=y
+CONFIG_SOC_IMX6SL=y
+CONFIG_SOC_IMX6SX=y
+CONFIG_SOC_IMX6UL=y
+CONFIG_CL_SOM_IMX6UL=y
+# CONFIG_SWP_EMULATE is not set
+# CONFIG_ARM_ERRATA_643719 is not set
+CONFIG_ARM_ERRATA_764369=y
+CONFIG_SMP=y
+CONFIG_HAVE_ARM_ARCH_TIMER=y
+CONFIG_VMSPLIT_2G=y
+CONFIG_HOTPLUG_CPU=y
+CONFIG_HIGHMEM=y
+CONFIG_SECCOMP=y
+CONFIG_CMDLINE="noinitrd console=ttymxc0,115200"
+CONFIG_CPU_FREQ=y
+CONFIG_CPU_FREQ_DEFAULT_GOV_INTERACTIVE=y
+CONFIG_CPU_FREQ_GOV_USERSPACE=y
+CONFIG_CPU_FREQ_GOV_ONDEMAND=y
+CONFIG_CPU_FREQ_GOV_CONSERVATIVE=y
+CONFIG_ARM_IMX6Q_CPUFREQ=y
+CONFIG_VFP=y
+CONFIG_NEON=y
+# CONFIG_SUSPEND is not set
+CONFIG_MODULES=y
+CONFIG_MODULE_UNLOAD=y
+CONFIG_MODVERSIONS=y
+CONFIG_MODULE_SRCVERSION_ALL=y
+# CONFIG_BLK_DEV_BSG is not set
+CONFIG_BINFMT_MISC=m
+CONFIG_CMA=y
+CONFIG_NET=y
+CONFIG_PACKET=y
+CONFIG_UNIX=y
+CONFIG_INET=y
+CONFIG_IP_PNP=y
+CONFIG_IP_PNP_DHCP=y
+# CONFIG_INET_XFRM_MODE_TRANSPORT is not set
+# CONFIG_INET_XFRM_MODE_TUNNEL is not set
+# CONFIG_INET_XFRM_MODE_BEET is not set
+CONFIG_NETFILTER=y
+CONFIG_NF_CONNTRACK=m
+CONFIG_NF_CONNTRACK_FTP=m
+CONFIG_NF_CONNTRACK_TFTP=m
+CONFIG_NETFILTER_XT_TARGET_CHECKSUM=m
+CONFIG_NETFILTER_XT_TARGET_CLASSIFY=m
+CONFIG_NETFILTER_XT_TARGET_CONNMARK=m
+CONFIG_NETFILTER_XT_TARGET_DSCP=m
+CONFIG_NETFILTER_XT_TARGET_IDLETIMER=m
+CONFIG_NETFILTER_XT_TARGET_LED=m
+CONFIG_NETFILTER_XT_TARGET_MARK=m
+CONFIG_NETFILTER_XT_TARGET_NFLOG=m
+CONFIG_NETFILTER_XT_TARGET_NFQUEUE=m
+CONFIG_NETFILTER_XT_TARGET_NOTRACK=m
+CONFIG_NETFILTER_XT_TARGET_TEE=m
+CONFIG_NETFILTER_XT_TARGET_TRACE=m
+CONFIG_NETFILTER_XT_TARGET_TCPMSS=m
+CONFIG_NETFILTER_XT_TARGET_TCPOPTSTRIP=m
+CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=m
+CONFIG_NETFILTER_XT_MATCH_CLUSTER=m
+CONFIG_NETFILTER_XT_MATCH_COMMENT=m
+CONFIG_NETFILTER_XT_MATCH_CONNBYTES=m
+CONFIG_NETFILTER_XT_MATCH_CONNLIMIT=m
+CONFIG_NETFILTER_XT_MATCH_CONNMARK=m
+CONFIG_NETFILTER_XT_MATCH_CONNTRACK=m
+CONFIG_NETFILTER_XT_MATCH_CPU=m
+CONFIG_NETFILTER_XT_MATCH_DEVGROUP=m
+CONFIG_NETFILTER_XT_MATCH_DSCP=m
+CONFIG_NETFILTER_XT_MATCH_ESP=m
+CONFIG_NETFILTER_XT_MATCH_HASHLIMIT=m
+CONFIG_NETFILTER_XT_MATCH_HELPER=m
+CONFIG_NETFILTER_XT_MATCH_IPRANGE=m
+CONFIG_NETFILTER_XT_MATCH_LENGTH=m
+CONFIG_NETFILTER_XT_MATCH_LIMIT=m
+CONFIG_NETFILTER_XT_MATCH_MAC=m
+CONFIG_NETFILTER_XT_MATCH_MARK=m
+CONFIG_NETFILTER_XT_MATCH_MULTIPORT=m
+CONFIG_NETFILTER_XT_MATCH_OSF=m
+CONFIG_NETFILTER_XT_MATCH_OWNER=m
+CONFIG_NETFILTER_XT_MATCH_POLICY=m
+CONFIG_NETFILTER_XT_MATCH_PKTTYPE=m
+CONFIG_NETFILTER_XT_MATCH_QUOTA=m
+CONFIG_NETFILTER_XT_MATCH_RATEEST=m
+CONFIG_NETFILTER_XT_MATCH_REALM=m
+CONFIG_NETFILTER_XT_MATCH_RECENT=m
+CONFIG_NETFILTER_XT_MATCH_STATE=m
+CONFIG_NETFILTER_XT_MATCH_STATISTIC=m
+CONFIG_NETFILTER_XT_MATCH_STRING=m
+CONFIG_NETFILTER_XT_MATCH_TCPMSS=m
+CONFIG_NETFILTER_XT_MATCH_TIME=m
+CONFIG_NETFILTER_XT_MATCH_U32=m
+CONFIG_IP_NF_IPTABLES=y
+CONFIG_IP_NF_MATCH_AH=m
+CONFIG_IP_NF_MATCH_ECN=m
+CONFIG_IP_NF_MATCH_RPFILTER=m
+CONFIG_IP_NF_MATCH_TTL=m
+CONFIG_IP_NF_FILTER=y
+CONFIG_IP_NF_TARGET_REJECT=y
+CONFIG_IP_NF_NAT=m
+CONFIG_IP_NF_TARGET_MASQUERADE=m
+CONFIG_IP_NF_TARGET_NETMAP=m
+CONFIG_IP_NF_TARGET_REDIRECT=m
+CONFIG_IP_NF_MANGLE=m
+CONFIG_IP_NF_TARGET_ECN=m
+CONFIG_IP_NF_TARGET_TTL=m
+CONFIG_IP_NF_RAW=m
+CONFIG_IP_NF_ARPTABLES=m
+CONFIG_IP_NF_ARPFILTER=m
+CONFIG_IP_NF_ARP_MANGLE=m
+CONFIG_IP6_NF_IPTABLES=y
+CONFIG_VLAN_8021Q=m
+CONFIG_VLAN_8021Q_GVRP=y
+CONFIG_LLC2=y
+CONFIG_CAN=y
+CONFIG_CAN_FLEXCAN=y
+CONFIG_CAN_M_CAN=y
+CONFIG_BT=y
+CONFIG_BT_RFCOMM=y
+CONFIG_BT_RFCOMM_TTY=y
+CONFIG_BT_BNEP=y
+CONFIG_BT_BNEP_MC_FILTER=y
+CONFIG_BT_BNEP_PROTO_FILTER=y
+CONFIG_BT_HIDP=y
+CONFIG_BT_HCIBTUSB=y
+CONFIG_BT_HCIUART=y
+CONFIG_BT_HCIUART_BCSP=y
+CONFIG_BT_HCIUART_ATH3K=y
+CONFIG_BT_HCIUART_LL=y
+CONFIG_BT_HCIBCM203X=y
+CONFIG_BT_ATH3K=y
+CONFIG_BT_WILINK=m
+CONFIG_CFG80211=y
+CONFIG_CFG80211_WEXT=y
+CONFIG_MAC80211=y
+CONFIG_RFKILL=y
+CONFIG_DEVTMPFS=y
+CONFIG_DEVTMPFS_MOUNT=y
+# CONFIG_STANDALONE is not set
+CONFIG_DMA_CMA=y
+CONFIG_CMA_SIZE_MBYTES=320
+CONFIG_IMX_WEIM=y
+CONFIG_CONNECTOR=y
+CONFIG_MTD=y
+CONFIG_MTD_CMDLINE_PARTS=y
+CONFIG_MTD_BLOCK=y
+CONFIG_MTD_CFI=y
+CONFIG_MTD_JEDECPROBE=y
+CONFIG_MTD_CFI_INTELEXT=y
+CONFIG_MTD_CFI_AMDSTD=y
+CONFIG_MTD_CFI_STAA=y
+CONFIG_MTD_PHYSMAP_OF=y
+CONFIG_MTD_DATAFLASH=y
+CONFIG_MTD_M25P80=y
+CONFIG_MTD_SST25L=y
+CONFIG_MTD_NAND=y
+CONFIG_MTD_NAND_GPMI_NAND=y
+CONFIG_MTD_NAND_MXC=y
+CONFIG_MTD_SPI_NOR=y
+CONFIG_SPI_FSL_QUADSPI=y
+CONFIG_MTD_UBI=y
+CONFIG_BLK_DEV_LOOP=y
+CONFIG_BLK_DEV_RAM=y
+CONFIG_BLK_DEV_RAM_SIZE=65536
+CONFIG_SENSORS_FXOS8700=y
+CONFIG_SENSORS_FXAS2100X=y
+CONFIG_EEPROM_AT24=y
+CONFIG_EEPROM_AT25=y
+CONFIG_TI_ST=y
+# CONFIG_SCSI_PROC_FS is not set
+CONFIG_BLK_DEV_SD=y
+CONFIG_SCSI_CONSTANTS=y
+CONFIG_SCSI_LOGGING=y
+CONFIG_SCSI_SCAN_ASYNC=y
+# CONFIG_SCSI_LOWLEVEL is not set
+CONFIG_ATA=y
+CONFIG_SATA_AHCI_PLATFORM=y
+CONFIG_AHCI_IMX=y
+CONFIG_PATA_IMX=y
+CONFIG_NETDEVICES=y
+CONFIG_TUN=m
+# CONFIG_NET_VENDOR_BROADCOM is not set
+CONFIG_CS89x0=y
+CONFIG_CS89x0_PLATFORM=y
+# CONFIG_NET_VENDOR_FARADAY is not set
+# CONFIG_NET_VENDOR_INTEL is not set
+# CONFIG_NET_VENDOR_MARVELL is not set
+# CONFIG_NET_VENDOR_MICREL is not set
+# CONFIG_NET_VENDOR_MICROCHIP is not set
+# CONFIG_NET_VENDOR_NATSEMI is not set
+# CONFIG_NET_VENDOR_SEEQ is not set
+CONFIG_SMC91X=y
+CONFIG_SMC911X=y
+CONFIG_SMSC911X=y
+# CONFIG_NET_VENDOR_STMICRO is not set
+CONFIG_MICREL_PHY=y
+CONFIG_PPP=y
+CONFIG_PPP_BSDCOMP=y
+CONFIG_PPP_DEFLATE=y
+CONFIG_PPP_FILTER=y
+CONFIG_USB_PEGASUS=m
+CONFIG_USB_RTL8150=m
+CONFIG_USB_RTL8152=m
+CONFIG_USB_USBNET=y
+CONFIG_USB_NET_AX8817X=m
+CONFIG_USB_NET_AX88179_178A=m
+CONFIG_USB_NET_CDCETHER=m
+CONFIG_USB_NET_CDC_EEM=m
+CONFIG_USB_NET_CDC_NCM=m
+CONFIG_USB_NET_NET1080=m
+CONFIG_USB_NET_MCS7830=y
+CONFIG_USB_NET_CDC_SUBSET=m
+CONFIG_USB_NET_ZAURUS=m
+CONFIG_ATH6KL=m
+CONFIG_ATH6KL_SDIO=m
+CONFIG_WL1251=y
+CONFIG_WL1251_SDIO=y
+CONFIG_WL18XX=m
+CONFIG_WLCORE=y
+CONFIG_WLCORE_SDIO=y
+CONFIG_INPUT_EVDEV=y
+CONFIG_INPUT_EVBUG=m
+CONFIG_KEYBOARD_GPIO=y
+CONFIG_KEYBOARD_IMX=y
+CONFIG_MOUSE_PS2=m
+CONFIG_MOUSE_PS2_ELANTECH=y
+CONFIG_INPUT_TOUCHSCREEN=y
+CONFIG_TOUCHSCREEN_ADS7846=y
+CONFIG_TOUCHSCREEN_EGALAX=y
+CONFIG_TOUCHSCREEN_ELAN=y
+CONFIG_TOUCHSCREEN_MAX11801=y
+CONFIG_TOUCHSCREEN_IMX6UL_TSC=y
+CONFIG_TOUCHSCREEN_MC13783=y
+CONFIG_TOUCHSCREEN_TSC2007=y
+CONFIG_TOUCHSCREEN_STMPE=y
+CONFIG_INPUT_MISC=y
+CONFIG_INPUT_MMA8450=y
+CONFIG_INPUT_UINPUT=y
+CONFIG_INPUT_MPL3115=y
+CONFIG_SENSOR_FXLS8471=y
+CONFIG_INPUT_ISL29023=y
+CONFIG_SERIO_SERPORT=m
+# CONFIG_LEGACY_PTYS is not set
+CONFIG_SERIAL_IMX=y
+CONFIG_SERIAL_IMX_CONSOLE=y
+CONFIG_SERIAL_FSL_LPUART=y
+CONFIG_SERIAL_FSL_LPUART_CONSOLE=y
+CONFIG_SERIAL_DEV_BUS=y
+CONFIG_FSL_OTP=y
+CONFIG_HW_RANDOM=y
+# CONFIG_I2C_COMPAT is not set
+CONFIG_I2C_CHARDEV=y
+# CONFIG_I2C_HELPER_AUTO is not set
+CONFIG_I2C_ALGOPCF=m
+CONFIG_I2C_ALGOPCA=m
+CONFIG_I2C_IMX=y
+CONFIG_SPI=y
+CONFIG_SPI_GPIO=y
+CONFIG_SPI_IMX=y
+CONFIG_GPIO_SYSFS=y
+CONFIG_GPIO_MAX732X=y
+CONFIG_GPIO_PCA953X=y
+CONFIG_GPIO_74X164=y
+CONFIG_POWER_RESET=y
+CONFIG_POWER_RESET_SYSCON_POWEROFF=y
+CONFIG_POWER_SUPPLY=y
+CONFIG_SABRESD_MAX8903=y
+CONFIG_SENSORS_MAX17135=y
+CONFIG_SENSORS_MAG3110=y
+CONFIG_THERMAL=y
+CONFIG_CPU_THERMAL=y
+CONFIG_IMX_THERMAL=y
+CONFIG_DEVICE_THERMAL=y
+CONFIG_WATCHDOG=y
+CONFIG_IMX2_WDT=y
+CONFIG_MFD_DA9052_I2C=y
+CONFIG_MFD_MC13XXX_SPI=y
+CONFIG_MFD_MC13XXX_I2C=y
+CONFIG_MFD_MAX17135=y
+CONFIG_MFD_SI476X_CORE=y
+CONFIG_MFD_STMPE=y
+CONFIG_REGULATOR=y
+CONFIG_REGULATOR_FIXED_VOLTAGE=y
+CONFIG_REGULATOR_ANATOP=y
+CONFIG_REGULATOR_DA9052=y
+CONFIG_REGULATOR_GPIO=y
+CONFIG_REGULATOR_MAX17135=y
+CONFIG_REGULATOR_MC13783=y
+CONFIG_REGULATOR_MC13892=y
+CONFIG_REGULATOR_PFUZE100=y
+CONFIG_MEDIA_SUPPORT=y
+CONFIG_MEDIA_CAMERA_SUPPORT=y
+CONFIG_MEDIA_RADIO_SUPPORT=y
+CONFIG_MEDIA_USB_SUPPORT=y
+CONFIG_USB_VIDEO_CLASS=m
+CONFIG_V4L_PLATFORM_DRIVERS=y
+CONFIG_VIDEO_MXC_OUTPUT=y
+CONFIG_VIDEO_MXC_CAPTURE=m
+CONFIG_VIDEO_MXC_CSI_CAMERA=m
+CONFIG_MXC_VADC=m
+CONFIG_MXC_MIPI_CSI=m
+CONFIG_MXC_CAMERA_OV5640=m
+CONFIG_MXC_CAMERA_OV5642=m
+CONFIG_MXC_CAMERA_OV5640_MIPI=m
+CONFIG_MXC_TVIN_ADV7180=m
+CONFIG_MXC_IPU_DEVICE_QUEUE_SDC=m
+CONFIG_VIDEO_MXC_IPU_OUTPUT=y
+CONFIG_VIDEO_MXC_PXP_V4L2=y
+CONFIG_SOC_CAMERA=y
+CONFIG_V4L_MEM2MEM_DRIVERS=y
+CONFIG_VIDEO_CODA=y
+CONFIG_RADIO_SI476X=y
+CONFIG_DRM=y
+CONFIG_DRM_VIVANTE=y
+CONFIG_FB_MXS=y
+CONFIG_FB_MXC_SYNC_PANEL=y
+CONFIG_FB_MXC_MIPI_DSI_SAMSUNG=y
+CONFIG_FB_MXC_TRULY_WVGA_SYNC_PANEL=y
+CONFIG_FB_MXC_LDB=y
+CONFIG_FB_MXC_HDMI=y
+CONFIG_FB_MXS_SII902X=y
+CONFIG_FB_MXC_DCIC=m
+CONFIG_HANNSTAR_CABC=y
+CONFIG_FB_MXC_EINK_PANEL=y
+CONFIG_FB_MXC_EINK_V2_PANEL=y
+CONFIG_LCD_CLASS_DEVICE=y
+CONFIG_LCD_L4F00242T03=y
+CONFIG_LCD_PLATFORM=y
+CONFIG_BACKLIGHT_PWM=y
+CONFIG_FRAMEBUFFER_CONSOLE=y
+CONFIG_LOGO=y
+CONFIG_SIL164_SIMPLE=y
+CONFIG_SOUND=y
+CONFIG_SND=y
+CONFIG_SND_USB_AUDIO=m
+CONFIG_SND_SOC=y
+CONFIG_SND_IMX_SOC=y
+CONFIG_SND_SOC_EUKREA_TLV320=y
+CONFIG_SND_SOC_IMX_WM8960=y
+CONFIG_SND_SOC_IMX_SII902X=y
+CONFIG_SND_SOC_IMX_WM8958=y
+CONFIG_SND_SOC_IMX_CS42888=y
+CONFIG_SND_SOC_IMX_WM8731=y
+CONFIG_SND_SOC_IMX_WM8962=y
+CONFIG_SND_SOC_IMX_SGTL5000=y
+CONFIG_SND_SOC_IMX_MQS=y
+CONFIG_SND_SOC_IMX_SPDIF=y
+CONFIG_SND_SOC_IMX_MC13783=y
+CONFIG_SND_SOC_IMX_SI476X=y
+CONFIG_SND_SOC_IMX_HDMI=y
+CONFIG_USB=y
+CONFIG_USB_OTG_WHITELIST=y
+CONFIG_USB_EHCI_HCD=y
+CONFIG_USB_EHCI_MXC=y
+CONFIG_USB_HCD_TEST_MODE=y
+CONFIG_USB_ACM=m
+CONFIG_USB_STORAGE=y
+CONFIG_USB_CHIPIDEA=y
+CONFIG_USB_CHIPIDEA_UDC=y
+CONFIG_USB_CHIPIDEA_HOST=y
+CONFIG_USB_SERIAL=m
+CONFIG_USB_SERIAL_GENERIC=y
+CONFIG_USB_SERIAL_FTDI_SIO=m
+CONFIG_USB_SERIAL_OPTION=m
+CONFIG_USB_EHSET_TEST_FIXTURE=y
+CONFIG_NOP_USB_XCEIV=y
+CONFIG_USB_MXS_PHY=y
+CONFIG_USB_GADGET=y
+CONFIG_USB_CONFIGFS=m
+CONFIG_USB_CONFIGFS_SERIAL=y
+CONFIG_USB_CONFIGFS_ACM=y
+CONFIG_USB_CONFIGFS_OBEX=y
+CONFIG_USB_CONFIGFS_NCM=y
+CONFIG_USB_CONFIGFS_ECM=y
+CONFIG_USB_CONFIGFS_ECM_SUBSET=y
+CONFIG_USB_CONFIGFS_RNDIS=y
+CONFIG_USB_CONFIGFS_EEM=y
+CONFIG_USB_CONFIGFS_MASS_STORAGE=y
+CONFIG_USB_CONFIGFS_F_LB_SS=y
+CONFIG_USB_CONFIGFS_F_FS=y
+CONFIG_USB_ZERO=m
+CONFIG_USB_ETH=m
+CONFIG_USB_G_NCM=m
+CONFIG_USB_GADGETFS=m
+CONFIG_USB_MASS_STORAGE=m
+CONFIG_USB_G_SERIAL=m
+CONFIG_MMC=y
+CONFIG_MMC_SDHCI=y
+CONFIG_MMC_SDHCI_PLTFM=y
+CONFIG_MMC_SDHCI_ESDHC_IMX=y
+# CONFIG_MXC_GPU_VIV is not set
+CONFIG_MXC_SIM=y
+CONFIG_MXC_IPU=y
+CONFIG_MXC_IPU_V3_PRE=y
+CONFIG_MXC_MIPI_CSI2=y
+CONFIG_NEW_LEDS=y
+CONFIG_LEDS_CLASS=y
+CONFIG_LEDS_GPIO=y
+CONFIG_LEDS_TRIGGERS=y
+CONFIG_LEDS_TRIGGER_TIMER=y
+CONFIG_LEDS_TRIGGER_ONESHOT=y
+CONFIG_LEDS_TRIGGER_HEARTBEAT=y
+CONFIG_LEDS_TRIGGER_BACKLIGHT=y
+CONFIG_LEDS_TRIGGER_GPIO=y
+CONFIG_RTC_CLASS=y
+CONFIG_RTC_INTF_DEV_UIE_EMUL=y
+CONFIG_RTC_DRV_EM3027=y
+CONFIG_RTC_DRV_MC13XXX=y
+CONFIG_RTC_DRV_MXC=y
+CONFIG_RTC_DRV_SNVS=y
+CONFIG_DMADEVICES=y
+CONFIG_IMX_SDMA=m
+CONFIG_MXS_DMA=y
+CONFIG_MXC_PXP_V2=y
+CONFIG_MXC_PXP_V3=y
+CONFIG_STAGING=y
+CONFIG_STAGING_MEDIA=y
+# CONFIG_IOMMU_SUPPORT is not set
+# CONFIG_IMX_RPMSG_PINGPONG is not set
+# CONFIG_IMX_RPMSG_TTY is not set
+CONFIG_IIO=y
+CONFIG_VF610_ADC=y
+CONFIG_PWM=y
+CONFIG_PWM_IMX=y
+CONFIG_EXT2_FS=y
+CONFIG_EXT2_FS_XATTR=y
+CONFIG_EXT2_FS_POSIX_ACL=y
+CONFIG_EXT2_FS_SECURITY=y
+CONFIG_EXT3_FS=y
+CONFIG_EXT3_FS_POSIX_ACL=y
+CONFIG_EXT3_FS_SECURITY=y
+CONFIG_QUOTA=y
+CONFIG_QUOTA_NETLINK_INTERFACE=y
+# CONFIG_PRINT_QUOTA_WARNING is not set
+CONFIG_AUTOFS4_FS=y
+CONFIG_FUSE_FS=y
+CONFIG_ISO9660_FS=m
+CONFIG_JOLIET=y
+CONFIG_ZISOFS=y
+CONFIG_UDF_FS=m
+CONFIG_MSDOS_FS=m
+CONFIG_VFAT_FS=y
+CONFIG_TMPFS=y
+CONFIG_TMPFS_XATTR=y
+CONFIG_JFFS2_FS=y
+CONFIG_UBIFS_FS=y
+CONFIG_NFS_FS=y
+CONFIG_NFS_V3_ACL=y
+CONFIG_NFS_V4=y
+CONFIG_ROOT_NFS=y
+CONFIG_NLS_DEFAULT="cp437"
+CONFIG_NLS_CODEPAGE_437=y
+CONFIG_NLS_ASCII=y
+CONFIG_NLS_ISO8859_1=y
+CONFIG_NLS_ISO8859_15=m
+CONFIG_NLS_UTF8=y
+CONFIG_SECURITYFS=y
+CONFIG_CRYPTO_USER=y
+CONFIG_CRYPTO_AUTHENC=y
+CONFIG_CRYPTO_TEST=m
+CONFIG_CRYPTO_CBC=y
+CONFIG_CRYPTO_CTS=y
+CONFIG_CRYPTO_LRW=y
+CONFIG_CRYPTO_XTS=y
+CONFIG_CRYPTO_MD4=y
+CONFIG_CRYPTO_MD5=y
+CONFIG_CRYPTO_MICHAEL_MIC=y
+CONFIG_CRYPTO_RMD128=y
+CONFIG_CRYPTO_RMD160=y
+CONFIG_CRYPTO_RMD256=y
+CONFIG_CRYPTO_RMD320=y
+CONFIG_CRYPTO_SHA1=y
+CONFIG_CRYPTO_SHA512=y
+CONFIG_CRYPTO_TGR192=y
+CONFIG_CRYPTO_WP512=y
+CONFIG_CRYPTO_BLOWFISH=y
+CONFIG_CRYPTO_CAMELLIA=y
+CONFIG_CRYPTO_DES=y
+CONFIG_CRYPTO_TWOFISH=y
+CONFIG_CRC_CCITT=m
+CONFIG_CRC_T10DIF=y
+CONFIG_FONTS=y
+CONFIG_FONT_8x8=y
+CONFIG_FONT_8x16=y
+CONFIG_DYNAMIC_DEBUG=y
+CONFIG_DEBUG_FS=y
+CONFIG_MAGIC_SYSRQ=y
+# CONFIG_SCHED_DEBUG is not set
+# CONFIG_DEBUG_BUGVERBOSE is not set
+# CONFIG_FTRACE is not set
+CONFIG_CORESIGHT=y
+CONFIG_CORESIGHT_LINK_AND_SINK_TMC=y
+CONFIG_CORESIGHT_SINK_TPIU=y
+CONFIG_CORESIGHT_SINK_ETBV10=y
+CONFIG_CORESIGHT_SOURCE_ETM3X=y
diff --git a/arch/arm/mach-imx/Kconfig b/arch/arm/mach-imx/Kconfig
index 7d07f3e96529..9492e981f499 100644
--- a/arch/arm/mach-imx/Kconfig
+++ b/arch/arm/mach-imx/Kconfig
@@ -565,6 +565,13 @@ config SOC_IMX6ULL
 	help
 	  This enables support for Freescale i.MX6 ULL processor.
 
+config CL_SOM_IMX6UL
+       bool "CompuLab SoM i.MX6ul board support"
+       depends on SOC_IMX6UL
+
+       help
+        This enables support for CompuLab SoM i.MX6ul board.
+
 config SOC_IMX7
 	bool
 	select CPU_V7
diff --git a/arch/arm/mach-imx/Makefile b/arch/arm/mach-imx/Makefile
index c1911857afd7..14d6f8f2627e 100644
--- a/arch/arm/mach-imx/Makefile
+++ b/arch/arm/mach-imx/Makefile
@@ -108,6 +108,7 @@ obj-$(CONFIG_SOC_IMX6SX) += mach-imx6sx.o ddr3_freq_imx6sx.o \
 			    lpddr2_freq_imx6sx.o
 obj-$(CONFIG_SOC_IMX6UL) += mach-imx6ul.o ddr3_freq_imx6sx.o \
 			    lpddr2_freq_imx6sx.o
+obj-$(CONFIG_CL_SOM_IMX6UL) += mach-cl-som-imx6ul.o
 obj-$(CONFIG_SOC_IMX7D) += mach-imx7d.o
 obj-$(CONFIG_SOC_IMX7ULP) += mach-imx7ulp.o pm-imx7ulp.o pm-rpmsg.o
 
diff --git a/arch/arm/mach-imx/mach-cl-som-imx6ul.c b/arch/arm/mach-imx/mach-cl-som-imx6ul.c
new file mode 100644
index 000000000000..8e464a15ee6d
--- /dev/null
+++ b/arch/arm/mach-imx/mach-cl-som-imx6ul.c
@@ -0,0 +1,74 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD. 
+ *
+ * This program is free software; you can redistribute it and/or modify
+ * it under the terms of the GNU General Public License version 2 as
+ * published by the Free Software Foundation.
+ */
+
+#include <linux/of_address.h>
+#include <linux/of_platform.h>
+#include <linux/io.h>
+#include <linux/regmap.h>
+#include <linux/mfd/syscon.h>
+#include <linux/mfd/syscon/imx6q-iomuxc-gpr.h>
+#include <asm/mach/arch.h>
+#include <asm/mach/map.h>
+
+static inline void __init cl_som_imx6ul_enet_clk_init(struct regmap *gpr)
+{
+	regmap_update_bits(gpr, IOMUXC_GPR1, IMX6UL_GPR1_ENET_CLK_DIR, 1<<13);
+}
+
+static inline void __init cl_som_imx6ul_sai2_clk_init(struct regmap *gpr)
+{
+	regmap_update_bits(gpr, IOMUXC_GPR1, 1<<20, 1<<20);
+}
+
+static void __init cl_som_imx6ul_clk_init(void)
+{
+	struct regmap *gpr;
+
+	gpr = syscon_regmap_lookup_by_compatible("fsl,imx6ul-iomuxc-gpr");
+	if (IS_ERR(gpr)) {
+		pr_err("failed to find fsl,imx6ul-iomux-gpr regmap\n");
+		return;
+	}
+	cl_som_imx6ul_enet_clk_init(gpr);
+	cl_som_imx6ul_sai2_clk_init(gpr);
+}
+
+static void __init cl_som_imx6ul_ccm_init(void)
+{
+#define BM_CLPCR_VSTBY			(0x1 << 8)
+#define CLPCR				0x54
+	void __iomem *ccm_base;
+	struct device_node *np;
+	u32 val;
+
+	np = of_find_compatible_node(NULL, NULL, "fsl,imx6ul-ccm");
+	ccm_base = of_iomap(np, 0);
+	BUG_ON(!ccm_base);
+
+	val = readl_relaxed(ccm_base + CLPCR);
+	val |= BM_CLPCR_VSTBY;
+	writel_relaxed(val, ccm_base + CLPCR);
+}
+
+static int __init cl_som_imx6ul_init(void)
+{
+	struct device_node *np;
+
+	np = of_find_compatible_node(NULL, NULL, "compulab,cl-som-imx6ul");
+
+	if (!np) {
+		pr_err("failed to find compulab,cl-som-imx6ul\n");
+		return -ENODEV;
+	}
+
+	cl_som_imx6ul_clk_init();
+	cl_som_imx6ul_ccm_init();
+
+	return 0;
+}
+subsys_initcall(cl_som_imx6ul_init);
diff --git a/arch/arm/mach-imx/mach-cl_som_imx6.c b/arch/arm/mach-imx/mach-cl_som_imx6.c
new file mode 100644
index 000000000000..48f1aac3b915
--- /dev/null
+++ b/arch/arm/mach-imx/mach-cl_som_imx6.c
@@ -0,0 +1,192 @@
+/*
+ *
+ * The code contained herein is licensed under the GNU General Public
+ * License. You may obtain a copy of the GNU General Public License
+ * Version 2 or later at the following locations:
+ *
+ * http://www.opensource.org/licenses/gpl-license.html
+ * http://www.gnu.org/copyleft/gpl.html
+ */
+
+#include <linux/module.h>
+#include <linux/of_platform.h>
+
+#include <linux/delay.h>
+#include <linux/err.h>
+#include <linux/io.h>
+#include <linux/of.h>
+#include <linux/of_address.h>
+#include <linux/mfd/syscon.h>
+#include <linux/mfd/syscon/imx6q-iomuxc-gpr.h>
+#include <linux/regmap.h>
+#include "common.h"
+#include "hardware.h"
+#include <linux/string.h>
+#include <linux/irq.h>
+#include <linux/interrupt.h>
+#include <linux/gpio.h>
+
+
+extern unsigned int system_rev;
+static unsigned int _system_rev;
+
+#define ANADIG_DIGPROG		0x260
+#define ANADIG_DIGPROG_IMX6SL	0x280
+
+extern unsigned int __mxc_cpu_type;
+
+static void revision_from_anatop(void)
+{
+	struct device_node *np;
+	void __iomem *anatop_base;
+	u32 cpu_type;
+	u16 offset = ANADIG_DIGPROG;
+	u32 fsl_system_rev = 0;
+
+	np = of_find_compatible_node(NULL, NULL, "fsl,imx6q-anatop");
+	anatop_base = of_iomap(np, 0);
+	WARN_ON(!anatop_base);
+	if (of_device_is_compatible(np, "fsl,imx6sl-anatop"))
+		offset = ANADIG_DIGPROG_IMX6SL;
+	cpu_type = readl_relaxed(anatop_base + offset);
+	iounmap(anatop_base);
+
+	/* Chip Silicon ID */
+	fsl_system_rev = ((cpu_type >> 16) & 0xFF) << 12;
+	/* Chip silicon major revision */
+	fsl_system_rev |= ((cpu_type >> 8) & 0xFF) << 4;
+	fsl_system_rev += 0x10;
+	/* Chip silicon minor revision */
+	fsl_system_rev |= cpu_type & 0xFF;
+
+	/*
+	 * Move the CompuLab board revision to a different variable,
+	 * so we can use it anytime it is needed.
+	 * Put the Freescale silicon revision information to the place where
+	 * the userspace video libraries expect it to be.
+	 */
+	system_rev = fsl_system_rev;
+}
+
+static void __init cl_som_imx6_csi_mux_init(void)
+{
+	/*
+	 * MX6Q sbc-fx6 board:
+	 * IPU1 CSI0 connects to parallel interface.
+	 * Set GPR1 bit 19 to 0x1.
+	 *
+	 * MX6DL sbc-fx6 board:
+	 * IPU1 CSI0 connects to parallel interface.
+	 * Set GPR13 bit 0-2 to 0x4.
+	 */
+	struct regmap *gpr;
+	struct device_node *np;
+	const char *status;
+	int ret;
+
+	/* Read mipi-csi status and set IPU1 CSI0 accordingly */
+	np = of_find_compatible_node(NULL, NULL, "fsl,imx6q-mipi-csi2");
+	if (np) {
+		ret = of_property_read_string(np, "status", &status);
+		if (!ret && (!strcasecmp(status, "okay"))) {
+			pr_info("IPU1 CSI0 is in mipi mode\n");
+			return;
+		}
+	}
+
+	gpr = syscon_regmap_lookup_by_compatible("fsl,imx6q-iomuxc-gpr");
+	if (!IS_ERR(gpr)) {
+		pr_info("IPU1 CSI0 is in parallel mode\n");
+		if (of_machine_is_compatible("fsl,imx6q"))
+			regmap_update_bits(gpr, IOMUXC_GPR1, 1 << 19, 1 << 19);
+		else if (of_machine_is_compatible("fsl,imx6dl"))
+			regmap_update_bits(gpr, IOMUXC_GPR13, 0x7, 0x4);
+	} else {
+		pr_err("%s(): failed to find fsl,imx6q-iomux-gpr regmap\n",
+		       __func__);
+	}
+}
+
+static void __init imx6qp_init(void)
+{
+	struct regmap *gpr;
+
+	pr_info("Set GPRx values for cl-som-imx6 imx6q/qp device\n");
+	gpr = syscon_regmap_lookup_by_compatible("fsl,imx6q-iomuxc-gpr");
+	if (!IS_ERR(gpr)) {
+		pr_info("1) GPR4: enable AXI cache for VDOA/VPU/IPU\n");
+		regmap_update_bits(gpr, IOMUXC_GPR4, 0xFFFFFFFF, 0xF00000CF);
+		pr_info("2) GPR6/7: set IPU AXI-id1 Qos=0x1 AXI-id0/2/3 Qos=0x7\n");
+		regmap_update_bits(gpr, IOMUXC_GPR6, 0xFFFFFFFF, 0x77177717);
+		regmap_update_bits(gpr, IOMUXC_GPR7, 0xFFFFFFFF, 0x77177717);
+	} else {
+		pr_err("%s(): failed to find fsl,imx6q-iomux-gpr regmap\n",
+		       __func__);
+	}
+}
+
+#ifdef CONFIG_KGDB
+#define	KGDB_GPIO IMX_GPIO_NR(7,13) /* SW6 */
+
+void kgdb_breakpoint(void);
+
+static irqreturn_t irq_handler(int irq, void *dev_id)
+{
+	static int count=0;
+
+	printk(KERN_DEBUG "interrupt received (irq[%d]: %d)\n", count++, irq);
+
+	kgdb_breakpoint();
+
+	return IRQ_HANDLED;
+}
+
+static void cl_som_imx6_kgdb_init(void)
+{
+	int ret;
+
+	ret = request_irq(gpio_to_irq(KGDB_GPIO),
+			irq_handler,
+			IRQF_TRIGGER_FALLING,
+			"irq_kgdb",
+			NULL);
+
+	if (ret)
+		printk(KERN_ERR
+			"cm-fx6: Failed to request irq for kgdb\n");
+
+}
+#else
+static void cl_som_imx6_kgdb_init(void){};
+#endif
+
+static int cl_som_imx6_init(void)
+{
+	struct device_node *np;
+
+	np = of_find_compatible_node(NULL, NULL, "compulab,cm-fx6");
+
+	if (!np)
+		return -EINVAL;
+
+	_system_rev = system_rev;
+	revision_from_anatop();
+	cl_som_imx6_csi_mux_init();
+
+	cl_som_imx6_kgdb_init();
+	imx6qp_init();
+
+	return 0;
+}
+
+static void __exit cl_som_imx6_exit(void)
+{
+	system_rev = _system_rev;
+}
+module_init(cl_som_imx6_init);
+module_exit(cl_som_imx6_exit);
+
+MODULE_AUTHOR("CompuLab, Ltd.");
+MODULE_DESCRIPTION("CompuLab CL-SOM-iMX6 machine driver");
+MODULE_LICENSE("GPL v2");
+MODULE_ALIAS("platform:cl-som-imx6");
diff --git a/drivers/video/Kconfig b/drivers/video/Kconfig
index 3ba39b94d28d..34e94c5758b9 100644
--- a/drivers/video/Kconfig
+++ b/drivers/video/Kconfig
@@ -46,4 +46,8 @@ if FB || SGI_NEWPORT_CONSOLE
 endif
 
 
+if CL_SOM_IMX6UL
+source "drivers/video/si/Kconfig"
+endif
+
 endmenu
diff --git a/drivers/video/Makefile b/drivers/video/Makefile
index df7650adede9..302e771c5498 100644
--- a/drivers/video/Makefile
+++ b/drivers/video/Makefile
@@ -13,3 +13,4 @@ obj-$(CONFIG_VIDEOMODE_HELPERS) += display_timing.o videomode.o
 ifeq ($(CONFIG_OF),y)
 obj-$(CONFIG_VIDEOMODE_HELPERS) += of_display_timing.o of_videomode.o
 endif
+obj-$(CONFIG_SIL164_SIMPLE)              += si/
diff --git a/drivers/video/si/Kconfig b/drivers/video/si/Kconfig
new file mode 100644
index 000000000000..300eae7e8bcd
--- /dev/null
+++ b/drivers/video/si/Kconfig
@@ -0,0 +1,6 @@
+config SIL164_SIMPLE
+	tristate "Silicon Image sil164 TMDS transmitter simple"
+	depends on I2C
+	help
+	  Support for sil164 simple used in some cl-sb-som boards.
+
diff --git a/drivers/video/si/Makefile b/drivers/video/si/Makefile
new file mode 100644
index 000000000000..6836f9614b51
--- /dev/null
+++ b/drivers/video/si/Makefile
@@ -0,0 +1,2 @@
+sil164_simple-y := sil164_simple_drv.o
+obj-$(CONFIG_SIL164_SIMPLE) += sil164_simple.o
diff --git a/drivers/video/si/sil164_simple_drv.c b/drivers/video/si/sil164_simple_drv.c
new file mode 100644
index 000000000000..90813f756836
--- /dev/null
+++ b/drivers/video/si/sil164_simple_drv.c
@@ -0,0 +1,241 @@
+/*
+ * Copyright (C) 2015 CompuLab LTD.
+ * All Rights Reserved.
+ *
+ */
+
+#include <linux/module.h>
+#include <linux/i2c.h>
+#include <linux/slab.h>
+
+struct sil164_encoder_params {
+	enum {
+		SIL164_INPUT_EDGE_FALLING = 0,
+		SIL164_INPUT_EDGE_RISING
+	} input_edge;
+
+	enum {
+		SIL164_INPUT_WIDTH_12BIT = 0,
+		SIL164_INPUT_WIDTH_24BIT
+	} input_width;
+
+	enum {
+		SIL164_INPUT_SINGLE_EDGE = 0,
+		SIL164_INPUT_DUAL_EDGE
+	} input_dual;
+
+	enum {
+		SIL164_PLL_FILTER_ON = 0,
+		SIL164_PLL_FILTER_OFF,
+	} pll_filter;
+
+	int input_skew; /** < Allowed range [-4, 3], use 0 for no de-skew. */
+	int duallink_skew; /** < Allowed range [-4, 3]. */
+};
+
+#define sil164_info(client, format, ...)		\
+	dev_info(&client->dev, format, __VA_ARGS__)
+#define sil164_err(client, format, ...)			\
+	dev_err(&client->dev, format, __VA_ARGS__)
+
+/* HW register definitions */
+
+#define SIL164_VENDOR_LO			0x0
+#define SIL164_VENDOR_HI			0x1
+#define SIL164_DEVICE_LO			0x2
+#define SIL164_DEVICE_HI			0x3
+#define SIL164_REVISION				0x4
+#define SIL164_FREQ_MIN				0x6
+#define SIL164_FREQ_MAX				0x7
+
+#define SIL164_CONTROL0				0x8
+#define SIL164_CONTROL0_POWER_ON		0x01
+#define SIL164_CONTROL0_EDGE_RISING		0x02
+#define SIL164_CONTROL0_INPUT_24BIT		0x04
+#define SIL164_CONTROL0_DUAL_EDGE		0x08
+#define SIL164_CONTROL0_HSYNC_ON		0x10
+#define SIL164_CONTROL0_VSYNC_ON		0x20
+
+#define SIL164_DETECT				0x9
+#define SIL164_DETECT_INTR_STAT			0x01
+#define SIL164_DETECT_HOTPLUG_STAT		0x02
+#define SIL164_DETECT_RECEIVER_STAT		0x04
+#define SIL164_DETECT_INTR_MODE_RECEIVER	0x00
+#define SIL164_DETECT_INTR_MODE_HOTPLUG		0x08
+#define SIL164_DETECT_OUT_MODE_HIGH		0x00
+#define SIL164_DETECT_OUT_MODE_INTR		0x10
+#define SIL164_DETECT_OUT_MODE_RECEIVER		0x20
+#define SIL164_DETECT_OUT_MODE_HOTPLUG		0x30
+#define SIL164_DETECT_VSWING_STAT		0x80
+
+#define SIL164_CONTROL1				0xa
+#define SIL164_CONTROL1_DESKEW_ENABLE		0x10
+#define SIL164_CONTROL1_DESKEW_INCR_SHIFT	5
+
+#define SIL164_GPIO				0xb
+
+#define SIL164_CONTROL2				0xc
+#define SIL164_CONTROL2_FILTER_ENABLE		0x01
+#define SIL164_CONTROL2_FILTER_SETTING_SHIFT	1
+#define SIL164_CONTROL2_DUALLINK_MASTER		0x40
+#define SIL164_CONTROL2_SYNC_CONT		0x80
+
+#define SIL164_DUALLINK				0xd
+#define SIL164_DUALLINK_ENABLE			0x10
+#define SIL164_DUALLINK_SKEW_SHIFT		5
+
+#define SIL164_PLLZONE				0xe
+#define SIL164_PLLZONE_STAT			0x08
+#define SIL164_PLLZONE_FORCE_ON			0x10
+#define SIL164_PLLZONE_FORCE_HIGH		0x20
+
+/* HW access functions */
+
+static void
+sil164_write(struct i2c_client *client, uint8_t addr, uint8_t val)
+{
+	uint8_t buf[] = {addr, val};
+	int ret;
+
+	ret = i2c_master_send(client, buf, ARRAY_SIZE(buf));
+	if (ret < 0)
+		sil164_err(client, "Error %d writing to subaddress 0x%x\n",
+			   ret, addr);
+}
+
+static uint8_t
+sil164_read(struct i2c_client *client, uint8_t addr)
+{
+	uint8_t val;
+	int ret;
+
+	ret = i2c_master_send(client, &addr, sizeof(addr));
+	if (ret < 0)
+		goto fail;
+
+	ret = i2c_master_recv(client, &val, sizeof(val));
+	if (ret < 0)
+		goto fail;
+
+	return val;
+
+fail:
+	sil164_err(client, "Error %d reading from subaddress 0x%x\n",
+		   ret, addr);
+	return 0;
+}
+
+static void
+sil164_set_power_state(struct i2c_client *client, bool on)
+{
+	uint8_t control0 = sil164_read(client, SIL164_CONTROL0);
+
+	if (on)
+		control0 |= SIL164_CONTROL0_POWER_ON;
+	else
+		control0 &= ~SIL164_CONTROL0_POWER_ON;
+
+	sil164_write(client, SIL164_CONTROL0, control0);
+}
+
+static void
+sil164_init_state(struct i2c_client *client,
+		  struct sil164_encoder_params *config,
+		  bool duallink)
+{
+	sil164_write(client, SIL164_CONTROL0,
+		     SIL164_CONTROL0_HSYNC_ON |
+		     SIL164_CONTROL0_VSYNC_ON |
+		     (config->input_edge ? SIL164_CONTROL0_EDGE_RISING : 0) |
+		     (config->input_width ? SIL164_CONTROL0_INPUT_24BIT : 0) |
+		     (config->input_dual ? SIL164_CONTROL0_DUAL_EDGE : 0));
+
+	sil164_write(client, SIL164_DETECT,
+		     SIL164_DETECT_INTR_STAT |
+		     SIL164_DETECT_OUT_MODE_RECEIVER);
+
+	sil164_write(client, SIL164_CONTROL1,
+		     (config->input_skew ? SIL164_CONTROL1_DESKEW_ENABLE : 0) |
+		     (((config->input_skew + 4) & 0x7)
+		      << SIL164_CONTROL1_DESKEW_INCR_SHIFT));
+
+	sil164_write(client, SIL164_CONTROL2,
+		     SIL164_CONTROL2_SYNC_CONT |
+		     (config->pll_filter ? 0 : SIL164_CONTROL2_FILTER_ENABLE) |
+		     (4 << SIL164_CONTROL2_FILTER_SETTING_SHIFT));
+
+	sil164_write(client, SIL164_PLLZONE, 0);
+
+	if (duallink)
+		sil164_write(client, SIL164_DUALLINK,
+			     SIL164_DUALLINK_ENABLE |
+			     (((config->duallink_skew + 4) & 0x7)
+			      << SIL164_DUALLINK_SKEW_SHIFT));
+	else
+		sil164_write(client, SIL164_DUALLINK, 0);
+}
+
+/* I2C driver functions */
+
+static int
+sil164_probe(struct i2c_client *client, const struct i2c_device_id *id)
+{
+	struct sil164_encoder_params *config;
+
+	int vendor = sil164_read(client, SIL164_VENDOR_HI) << 8 |
+		sil164_read(client, SIL164_VENDOR_LO);
+	int device = sil164_read(client, SIL164_DEVICE_HI) << 8 |
+		sil164_read(client, SIL164_DEVICE_LO);
+	int rev = sil164_read(client, SIL164_REVISION);
+
+	if (vendor != 0x1 || device != 0x6) {
+		sil164_info(client, "Unknown device %x:%x.%x\n",
+			   vendor, device, rev);
+		return -ENODEV;
+	}
+
+	config = kzalloc(sizeof(*config), GFP_KERNEL);
+	if (!config)
+		return -ENOMEM;
+
+	config->input_width = SIL164_CONTROL0_INPUT_24BIT;
+
+	sil164_init_state(client, config, 0);
+
+	sil164_set_power_state(client, 1); 
+
+	sil164_info(client, "Detected device %x:%x.%x\n",
+		    vendor, device, rev);
+
+	kfree(config);
+
+	return 0;
+}
+
+static int
+sil164_remove(struct i2c_client *client)
+{
+	sil164_set_power_state(client, 0); 
+	return 0;
+}
+
+static struct i2c_device_id sil164_ids[] = {
+	{ "sil164_simple", 0 },
+	{ }
+};
+MODULE_DEVICE_TABLE(i2c, sil164_ids);
+
+static struct i2c_driver sil164_simple_driver = {
+		.probe = sil164_probe,
+		.remove = sil164_remove,
+		.driver = {
+			.name = "sil164_simple",
+		},
+		.id_table = sil164_ids,
+};
+
+module_i2c_driver(sil164_simple_driver);
+
+MODULE_AUTHOR("CompuLab Ltd.");
+MODULE_DESCRIPTION("Silicon Image sil164 TMDS transmitter simple driver");
+MODULE_LICENSE("GPL and additional rights");
-- 
2.17.1

